prefixes:
  ex:   "http://group20.linkeddata.es/parkings/resource/"
  my:   "https://data.smartcitymadrid.es/ontology/parking#"
  schema: "http://schema.org/"
  geo:  "http://www.opengis.net/ont/geosparql#"
  dct:  "http://purl.org/dc/terms/"
  xsd:  "http://www.w3.org/2001/XMLSchema#"

sources:
  - [parkings-updated.csv~csv]

mappings:

  ParkingFacility:
    sources:
      - [parkings-updated.csv~csv]
    s: ex:$(identifier)
    po:
      - [a, schema:ParkingFacility]
      - p: dct:identifier
        o: {value: $(identifier), datatype: xsd:int}
      - p: my:hasFamily
        o: {value: $(family), datatype: xsd:int}
      - [schema:name, $(name)]
      - [my:hasCategory, $(category)]
      - p: my:hasCategoryCode
        o: {value: $(categoryCode), datatype: xsd:int}
      - [my:hasURLIcon, $(URLIcon)~iri]
      - p: my:isEMTParking
        o: {value: $(EMTParking), datatype: xsd:boolean}
      - [my:hasType, $(type)]
      - [schema:address, ex:address/$(identifier)~iri]
      - [geo:hasGeometry, ex:geom/$(identifier)~iri]
      - [my:containedInCity, ex:city/$(city)~iri]

  PostalAddress:
    sources:
      - [parkings-updated.csv~csv]

    s: ex:address/$(identifier)
    po:
      - [a, schema:PostalAddress]
      - [schema:streetAddress, $(streetAddress)]
      - [owl:sameAs, $(linkedAddressStreet)~iri]

      - p: schema:postalCode
        o: {value: $(postalCode), datatype: xsd:int}
      - [schema:addressLocality, $(city)]
      - [schema:addressRegion,   $(autonomousCommunity)]
      - [schema:addressCountry,  $(country)]

  Geometry:
    sources:
      - [parkings-updated.csv~csv]
    s: ex:geom/$(identifier)
    po:
      - [a, geo:Point]
      - p: geo:long
        o: { value: $(long), datatype: xsd:double }
      - p: geo:lat
        o: { value: $(lat), datatype: xsd:double }
      - p: geo:asWKT
        o: "POINT($(long) $(lat))"
        o_datatype: "http://www.opengis.net/ont/geosparql#wktLiteral" 

  City:
    sources:
      - [parkings-updated.csv~csv]
    s: ex:city/$(city)
    po:
      - [a, schema:City]
      - [schema:name, $(city)]
      - [owl:sameAs, $(wikidataCity)~iri]
      - [my:containedInRegion, ex:region/$(autonomousCommunity)~iri]
      - [my:containedInNation, ex:country/$(country)~iri]

  Region:
    sources:
      - [parkings-updated.csv~csv]
    s: ex:region/$(autonomousCommunity)
    po:
      - [a, my:AutonomousCommunity]
      - [owl:sameAs, $(wikidataAutonomousCommunity)~iri]
      - [schema:name, $(autonomousCommunity)]
      - [my:containedInCountry, ex:country/$(country)~iri]
  Country:
    sources: 
      - [parkings-updated.csv~csv]
    s: ex:country/$(country)
    po:
      - [a, schema:Country]
      - [owl:sameAs, $(wikidataCountry)~iri]
      - [schema:name, $(country)]
      